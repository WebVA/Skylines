{% extends "base-page.jinja" %}
{% set active_page = "upload" %}

{% from 'upload/details.jinja' import render_flight_details with context %}

{% block title %}{% trans %}Upload Flight{% endtrans %}{% endblock %}

{%- block content %}
<form action="{{ url_for('upload.index') }}" method="post">
  <input type="hidden" name="num_flights" value="{{ num_flights }}" />
  <input type="hidden" name="stage" value="1" />
  {% if success -%}
  <p class="visible-xs">
    {% trans %}Your flights have been saved.{% endtrans %}<br />
  </p>
  <p class="hidden-xs">
    {% trans %}Your flights have been saved. You may want to change the flights aircraft types and registrations below.{% endtrans %}<br />
  </p>
  <p class="hidden-xs">
    <input type="submit" id="submit" value="{{ _('Update Aircraft Types and Registrations') }}" class="btn btn-primary"/>
  </p>
  {%- else %}
  <p>{% trans %}No flight was saved.{% endtrans %}</p>
  {%- endif %}
  <div class="col-sm-3">
    <ul class="nav nav-tabs tabs-left">
      {% for name, flight, status, prefix, form in flights -%}
      <li {% if loop.first -%} class="active" {%- endif %}>
        <input type="hidden" name="{{ prefix }}-status" value="{{ status.value }}" />
        <input type="hidden" name="{{ prefix }}-name" value="{{ name }}" />
        {% if flight %}
        <input type="hidden" id="{{ prefix }}-sfid" name="{{ prefix }}-sfid" value="{{ flight.id }}" />
        {% endif %}
        <a href="#upload-tab-{{ prefix }}" data-toggle="tab">{{ name }}</a>
      </li>
      {%- endfor %}
    </ul>
  </div>
  <div class="col-sm-9">
    <div class="tab-content">
      {% for name, flight, status, prefix, form in flights -%}
      <div class="tab-pane {% if loop.first -%}active{%- endif %}" id="upload-tab-{{ prefix }}">
        {{ render_flight_details(name, flight, status, prefix, form) }}
      </div>
      {%- endfor %}
    </div>
  </div>

  <div class="clearfix"></div>

  {% if success -%}
  <p class="hidden-xs"><input type="submit" id="submit" value="{{ _('Update Aircraft Types and Registrations') }}" class="btn btn-primary"/></p>
  {%- endif %}
</form>

<p><a href="{{ url_for('.index') }}" class="btn btn-default">{% trans %}Upload another flight{% endtrans %}</a></p>
{%- endblock %}
