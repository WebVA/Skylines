<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">

  <xi:include href="master/page.html" />

  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" py:if="False"/>
    <script src="/js/jquery.js" type="text/javascript" language="javascript" />
    <script src="/js/jquery.dataTables.js" type="text/javascript" language="javascript" />
    <script src="/js/jquery.dataTables.ext.js" type="text/javascript" language="javascript" />

    <link href="/css/dataTables.bootstrap.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" charset="utf-8">
    /* <![CDATA[ */
      $(document).ready(function() {
        $('#flight-table').dataTable({
          "bProcessing": true,
          "sPaginationType": "bootstrap",
          "iDisplayLength": ${repr(int(config.get('skylines.lists.display_length', 50)))},
          "iDeferLoading": ${flights_count},
          "bServerSide": (${flights_count} > ${repr(int(config.get('skylines.lists.server_side', 250)))})?true:false,
          "sAjaxSource": (${flights_count} > ${repr(int(config.get('skylines.lists.server_side', 250)))})?"${request.url}?json=true":null,
          "sDom": "<'row'<'span6'i><'span6'p>>rt<'row'<'span6'i><'span6'p>>",
          "aaSorting": [[ 0, "desc" ]],
          "aoColumnDefs": [
            { "bSortable": false, "aTargets": [-1] },
            { "sType": "numeric-comma-formatted", "aTargets": ["numeric"] },
          ]
        });
      });
    /* ]]> */
    </script>

    <title py:if="pilot">Flights of pilot "${pilot}"</title>
    <title py:if="club">Flights of club "${club}"</title>"
    <title py:if="not pilot and not club">Flight list</title>
  </head>

  <?python from babel.dates import format_date ?>

  <body>
    <ul class="nav nav-tabs">
      <li class="${('', 'active')[defined('tab') and tab == 'all']}"><a href="/flights/">All Flights</a></li>
      <li py:if="request.identity" class="${('', 'active')[defined('tab') and tab == 'my']}"><a href="/flights/my">My Flights</a></li>
      <li py:if="request.identity and request.identity['user'].club_id" class="${('', 'active')[defined('tab') and tab == 'my_club']}"><a href="/flights/my_club">My Club's Flights</a></li>
      <li py:if="request.identity" class="${('', 'active')[defined('tab') and tab == 'unassigned']}"><a href="/flights/unassigned">Unassigned Flights</a></li>
      <li class="${('', 'active')[defined('tab') and tab == 'top']}"><a href="/flights/top">Top Pilots</a></li>
    </ul>

    <h3 py:if="pilot">
      Flights of pilot "${pilot}"
    </h3>

    <h3 py:if="club">
      Flights of club "<a href="/clubs/id/${club.id}/">${club}</a>"
    </h3>

      <div id="getting_started">
        <table id="flight-table" class="table table-striped">
          <thead>
            <tr>
              <th>Date</th>
              <th class="numeric">Score</th>
              <th>Pilot</th>
              <th class="numeric">Distance</th>
              <th>Club</th>
              <th>Time</th>
              <th>Show</th>
            </tr>
          </thead>
          <tbody>
            <tr py:for="flight in flights">
              <td>
                <span py:if="flight.takeoff_time" py:replace="format_date(flight.takeoff_time)">
                  2012-05-21
                </span>
              </td>
              <td class="numeric" py:content="flight.olc_plus_score">
                500
              </td>
              <td>
                <a py:if="flight.pilot" py:content="flight.pilot" href="/flights/pilot/${flight.pilot_id}">
                  Pilot Name
                </a>
                <br py:if="flight.pilot and flight.co_pilot"/>
                <a py:if="flight.co_pilot" py:content="flight.co_pilot" href="/flights/pilot/${flight.co_pilot_id}">
                  Co-Pilot Name
                </a>
                <span py:if="not flight.pilot and not flight.co_pilot" py:strip="True">
                  [${flight.owner}]
                </span>
              </td>
              <td class="numeric">
                <span py:if="flight.olc_classic_distance is not None">
                  <span py:content="flight.olc_classic_distance / 1000">500</span> km
                </span>
              </td>
              <td>
                <a py:if="flight.club" py:content="flight.club" href="/flights/club/${flight.club_id}">
                  Club Name
                </a>
              </td>
              <td>
                <span py:if="flight.takeoff_time and flight.landing_time" py:strip="True">
                  <span py:replace="flight.takeoff_time.strftime('%H:%M')">10:00</span>-<span py:replace="flight.landing_time.strftime('%H:%M')">15:00</span>
                </span>
              </td>
              <td>
                <a href="/flights/id/${flight.id}/">
                  Show
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
  </body>
</html>
